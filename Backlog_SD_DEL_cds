@AbapCatalog.sqlViewName: 'ZAEU_DELQ'
@AbapCatalog.compiler.compareFilter: true
@AbapCatalog.preserveKey: true
@AccessControl.authorizationCheck: #NOT_REQUIRED
@EndUserText.label: 'Helper CDS for delivered quantity'
@Metadata.ignorePropagatedAnnotations: true
define view ZAEU_DELQ_CDS as select from lips
  inner join likp
    on likp.vbeln = lips.vbeln
{
  key lips.vgbel,
  key lips.vgpos,
  sum( lips.lfimg ) as del_qty,
  max( lips.vbeln ) as delivery_note
}
group by lips.vgbel, lips.vgpos
